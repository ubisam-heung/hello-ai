# Hello DB - 시스템 아키텍처

## 전체 시스템 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                        클라이언트 (브라우저)                        │
│                      http://localhost:8080                       │
└──────────────────────────────┬──────────────────────────────────┘
                               │
                               │ HTTP 요청/응답
                               │
┌──────────────────────────────┴──────────────────────────────────┐
│                    프론트엔드 (Vue 3 + Vuetify)                   │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                        App.vue                             │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌─────────────────┐ │ │
│  │  │ DB 선택      │  │ 사용자 폼    │  │ 데이터 테이블   │ │ │
│  │  │ (드롭다운)   │  │ (이름, 이메일)│  │ (CRUD 버튼)     │ │ │
│  │  └──────────────┘  └──────────────┘  └─────────────────┘ │ │
│  └────────────────────────────────────────────────────────────┘ │
│                              Axios                               │
└──────────────────────────────┬──────────────────────────────────┘
                               │
                               │ REST API
                               │
┌──────────────────────────────┴──────────────────────────────────┐
│              백엔드 API 서버 (Express.js)                         │
│                   http://localhost:3000                          │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                      Middleware                            │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌──────────────────┐  │ │
│  │  │ Rate Limit  │  │    CORS     │  │  JSON Parser     │  │ │
│  │  └─────────────┘  └─────────────┘  └──────────────────┘  │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                        Routes                              │ │
│  │  /api/mysql/users      /api/mariadb/users                 │ │
│  │  /api/postgresql/users /api/oracle/users                  │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │                   Database Modules                         │ │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐    │ │
│  │  │  mysql   │ │ mariadb  │ │postgresql│ │  oracle  │    │ │
│  │  │  .js     │ │  .js     │ │  .js     │ │  .js     │    │ │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘    │ │
│  └────────────────────────────────────────────────────────────┘ │
└──────────┬───────────┬────────────┬──────────┬─────────────────┘
           │           │            │          │
           │           │            │          │
           ▼           ▼            ▼          ▼
┌──────────────┐ ┌──────────┐ ┌───────────┐ ┌─────────┐
│   MySQL      │ │ MariaDB  │ │PostgreSQL │ │ Oracle  │
│   Container  │ │Container │ │ Container │ │Container│
│              │ │          │ │           │ │         │
│ Port: 3306   │ │Port: 3307│ │Port: 5432 │ │Port:1521│
│              │ │          │ │           │ │Port:5500│
│ Volume:      │ │Volume:   │ │Volume:    │ │Volume:  │
│ mysql-data   │ │mariadb-  │ │postgres-  │ │oracle-  │
│              │ │data      │ │data       │ │data     │
└──────────────┘ └──────────┘ └───────────┘ └─────────┘
     (Docker)       (Docker)      (Docker)     (Docker)
```

## API 요청 흐름

### CREATE (POST) - 사용자 추가
```
Client → POST /api/mysql/users { name, email }
         ↓
      Rate Limiter (요청 제한 확인)
         ↓
      CORS (헤더 검증)
         ↓
      JSON Parser (본문 파싱)
         ↓
      MySQL Route Handler
         ↓
      MySQL Connection Pool
         ↓
      INSERT INTO users (name, email) VALUES (?, ?)
         ↓
      ID 자동 생성
         ↓
      SELECT * FROM users WHERE id = ?
         ↓
      Response { id, name, email, created_at }
```

### READ (GET) - 사용자 조회
```
Client → GET /api/postgresql/users
         ↓
      Rate Limiter
         ↓
      PostgreSQL Route Handler
         ↓
      PostgreSQL Connection Pool
         ↓
      SELECT * FROM users ORDER BY created_at DESC
         ↓
      Response [{ user1 }, { user2 }, ...]
```

### UPDATE (PUT) - 사용자 수정
```
Client → PUT /api/mariadb/users/1 { name, email }
         ↓
      Rate Limiter
         ↓
      MariaDB Route Handler
         ↓
      MariaDB Connection Pool
         ↓
      UPDATE users SET name=?, email=? WHERE id=?
         ↓
      SELECT * FROM users WHERE id=?
         ↓
      Response { id, name, email, created_at }
```

### DELETE (DELETE) - 사용자 삭제
```
Client → DELETE /api/oracle/users/1
         ↓
      Rate Limiter
         ↓
      Oracle Route Handler
         ↓
      Oracle Connection
         ↓
      DELETE FROM users WHERE id=:id
         ↓
      COMMIT
         ↓
      Response { message: "User deleted successfully" }
```

## 데이터 흐름

```
┌────────────────────────────────────────────────────────┐
│ 1. 사용자가 DB 선택 드롭다운에서 "MySQL" 선택           │
│    → loadUsers() 호출                                   │
│    → GET /api/mysql/users                               │
│    → 사용자 목록 화면에 표시                            │
└────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────┐
│ 2. 사용자가 폼에 이름과 이메일 입력 후 "추가" 클릭      │
│    → 폼 유효성 검사                                     │
│    → POST /api/mysql/users { name, email }              │
│    → 서버에서 ID 자동 생성                              │
│    → 새 사용자 반환                                     │
│    → 목록 새로고침                                      │
│    → 성공 스낵바 표시                                   │
└────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────┐
│ 3. 사용자가 목록에서 "수정" 버튼 클릭                   │
│    → 사용자 데이터를 폼에 채움                          │
│    → editingUser 상태 업데이트                          │
│    → 사용자가 정보 수정 후 "수정" 클릭                  │
│    → PUT /api/mysql/users/:id { name, email }           │
│    → 수정된 사용자 반환                                 │
│    → 목록 새로고침                                      │
│    → 폼 초기화                                          │
└────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────┐
│ 4. 사용자가 목록에서 "삭제" 버튼 클릭                   │
│    → 확인 대화상자 표시                                 │
│    → 확인 시 DELETE /api/mysql/users/:id                │
│    → 삭제 성공 메시지 반환                              │
│    → 목록 새로고침                                      │
│    → 삭제 완료 스낵바 표시                              │
└────────────────────────────────────────────────────────┘
```

## 보안 계층

```
┌───────────────────────────────────────────────────────┐
│                   보안 계층                            │
│ ┌───────────────────────────────────────────────────┐ │
│ │ 1. Rate Limiting                                  │ │
│ │    - 15분당 100 요청 제한                         │ │
│ │    - IP 기반 제한                                 │ │
│ └───────────────────────────────────────────────────┘ │
│ ┌───────────────────────────────────────────────────┐ │
│ │ 2. CORS                                           │ │
│ │    - Cross-Origin 요청 관리                       │ │
│ │    - 허용된 도메인만 접근                         │ │
│ └───────────────────────────────────────────────────┘ │
│ ┌───────────────────────────────────────────────────┐ │
│ │ 3. 환경 변수                                      │ │
│ │    - 민감 정보 .env 파일로 분리                   │ │
│ │    - DB 비밀번호 소스코드에서 분리                │ │
│ └───────────────────────────────────────────────────┘ │
│ ┌───────────────────────────────────────────────────┐ │
│ │ 4. 연결 풀링                                      │ │
│ │    - 안전한 연결 관리                             │ │
│ │    - 자동 재연결                                  │ │
│ └───────────────────────────────────────────────────┘ │
└───────────────────────────────────────────────────────┘
```

## 스케일링 고려사항

### 수평 확장
```
                    Load Balancer
                         │
           ┌─────────────┼─────────────┐
           ▼             ▼             ▼
       API Server 1  API Server 2  API Server 3
           │             │             │
           └─────────────┼─────────────┘
                         │
                    DB Cluster
```

### 캐싱 전략
```
Client → API Server → Cache (Redis) → Database
                          │
                          └─→ Cache Hit (빠른 응답)
                          └─→ Cache Miss (DB 조회)
```

이 아키텍처는 확장 가능하고 유지보수가 용이하도록 설계되었습니다.
